<!DOCTYPE HTML>
<html>
<head>
    <script type="text/javascript" src="https://static.95516.com/static/help/js/jquery-1.7.2.min.js"></script>
    <script type="text/javascript" src="./rgbaster.js"></script>
    <style type="text/css">

        header {
            text-align: center;
            line-height: 50px;
        }

        .file {

        }

        .back {
            float: left;
        }

        .logo {
            width: 60%;
            margin: 10% 20px;
        }

        .main,.secondary,.third {
            height: 200px;
            width: 120px;
            float: left;
        }

    </style>
</head>
<body>
<header>获取图片主色</header>

<div class="selectFile">
    <input type="file" class="file" id="file">
    <label class="fileBtn" for="file" title="JPG,GIF,PNG">请选择图片</label>
</div>

<div id="test" class="back">
</div>
<div class="logo" id="logo">
    <img id="imgDemo" src="./华润苏果.jpg" alt="将src替换成想测试的图片名称！">
</div>

<div id="main" class="main">
    获取的主色
</div>
<div id="secondary" class="secondary">
    获取的secondary色
</div>
<div id="third" class="third">
    获取的third色
</div>

<script type="text/javascript">
    var img = document.getElementById('imgDemo');

    var makeRGB = function (name) {
        return ['rgb(', name, ')'].join('');
    };

    RGBaster.colors(img, {
        exclude: [],
        success: function (payload) {
            // payload.dominant是主色，RGB形式表示
            // payload.secondary是次色，RGB形式表示
            // payload.palette是调色板，含多个主要颜色，数组
            console.log(payload.dominant);
            console.log(payload.secondary);
            console.log(payload.palette);

            $("#logo").css("background-color", makeRGB(payload.dominant + ',0.1'));
//            $("#logo").css("opacity", "0.1");

            $("#main").css("background-color", makeRGB(payload.dominant));
            $("#secondary").css("background-color", makeRGB(payload.palette[1]));
            $("#third").css("background-color", makeRGB(payload.palette[5]));
        }
    });

    window.onload = function () {

        //选择图片事件
        document.getElementById('file').onchange = function () {
            var img = event.target.files[0];
            console.log(img);


            // 检查能否读取图片（用户取消等）
            if (!img) {
                return;
            }

            // 检查图片类型
            if (!(img.type.indexOf('image') == 0 && img.type && /\.(?:jpg|png|gif)$/.test(img.name))) {
                alert('图片只能是jpg,gif,png');
                return;
            }

            // 检查图片尺寸
            if (img.size > 120 * 1024) {
                alert('图片不能大于120K');
                return;
            }

            // file reader
            var reader = new FileReader();
            reader.readAsDataURL(img);

            // reader onload start
            reader.onload = function (e) {


            }
        }
    }
</script>

</body>
</html>